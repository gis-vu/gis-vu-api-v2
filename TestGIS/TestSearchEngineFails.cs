using System;
using System.Collections.Generic;
using System.Text;
using DTOs;
using LoadGIS;
using Newtonsoft.Json;
using SearchGIS;
using Xunit;

namespace TestGIS
{
    public class TestSearchEngineFails
    {
        [Fact]
        public void FindFailingRoute()
        {
            
            var searchEngine = new SearchEngine(new Loader(
                @"C:\Users\daini\Desktop\GIS\Projektas\Projektas.V2\API2\GIS.VU.API\Data\grid.txt",
                @"C:\Users\daini\Desktop\GIS\Projektas\Projektas.V2\API2\GIS.VU.API\Data\"));


            var request = "{\r\n    \"start\": {\r\n        \"lng\": 25.36195062832462,\r\n        \"lat\": 55.9980682640022\r\n    },\r\n    \"end\": {\r\n        \"lng\": 25.340408464704154,\r\n        \"lat\": 55.96880735540407\r\n    },\r\n    \"points\": [\r\n        {\r\n            \"lng\": 25.331229849730477,\r\n            \"lat\": 55.99517953392049\r\n        },\r\n        {\r\n            \"lng\": 25.31992246656779,\r\n            \"lat\": 55.98136207952609\r\n        }\r\n    ],\r\n    \"polygonPoints\": [\r\n        {\r\n            \"lng\": 25.295615495784347,\r\n            \"lat\": 56.00840510797073\r\n        },\r\n        {\r\n            \"lng\": 25.395661925191945,\r\n            \"lat\": 56.00673315891433\r\n        },\r\n        {\r\n            \"lng\": 25.376359489070666,\r\n            \"lat\": 55.95304036722544\r\n        },\r\n        {\r\n            \"lng\": 25.290450055145158,\r\n            \"lat\": 55.960345749258266\r\n        },\r\n        {\r\n            \"lng\": 25.295615495784347,\r\n            \"lat\": 56.00840510797073\r\n        }\r\n    ],\r\n    \"searchOptions\": {\r\n        \"trackOverlapImportance\": \"1\",\r\n        \"propertyValueImportance\": [\r\n            {\r\n                \"property\": \"distance_to_forrest\",\r\n                \"threshold\": 0,\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"distance_to_water\",\r\n                \"threshold\": \"50\",\r\n                \"importance\": \"1\"\r\n            }\r\n        ],\r\n        \"propertyImportance\": [\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"bridleway\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"cycleway\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"path\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"footway\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"steps\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"living_street\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"pedestrian\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"residential\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"service\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"tertiary\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track_grade1\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track_grade2\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track_grade3\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track_grade4\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"track_grade5\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"unclassified\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"motorway\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"motorway_link\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"primary\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"primary_link\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"secondary\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"secondary_link\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"trunk\",\r\n                \"importance\": \"1\"\r\n            },\r\n            {\r\n                \"property\": \"fclass\",\r\n                \"value\": \"trunk_link\",\r\n                \"importance\": \"1\"\r\n            }\r\n        ]\r\n    }\r\n}";

            var route = searchEngine.FindRoute(JsonConvert.DeserializeObject<RouteSearchRequestDTO>(request));
        }
    }
}
